{% comment %}
  Translation notice component - shows when content is LLM-translated
  Displays banner with provider info and dismissal functionality
{% endcomment %}

{% if page.lang == 'en' and page.original_language %}
  <div id="translation-notice" class="alert alert-info alert-dismissible fade show mb-3" role="alert">
    <i class="fas fa-language me-2"></i>
    <strong>{{ site.data.locales[page.lang].translation.notice_title | default: 'Auto-translated content' }}</strong>

    <span class="translation-details">
      {% assign provider = page.translation_provider | default: 'AI' %}
      {% assign original_lang = page.original_language | default: 'zh-CN' %}
      {% assign original_lang_name = site.data.locales[page.lang].languages[original_lang] | default: original_lang %}

      {{
        site.data.locales[page.lang].translation.notice_message
        | default: 'This content was automatically translated from'
      }}
      <strong>{{ original_lang_name }}</strong>
      {{ site.data.locales[page.lang].translation.using | default: 'using' }}
      <strong>{{ provider }}</strong>.
      {{ site.data.locales[page.lang].translation.quality_disclaimer | default: 'Translation quality may vary.' }}
    </span>

    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="{{ site.data.locales[page.lang].translation.dismiss | default: 'Close' }}"
    ></button>
  </div>
{% endif %}

<style>
  #translation-notice {
    border-left: 4px solid #0dcaf0;
    background-color: rgba(13, 202, 240, 0.1);
  }

  #translation-notice .fas.fa-language {
    color: #0dcaf0;
  }

  .translation-details {
    display: block;
    margin-top: 0.25rem;
    font-size: 0.9rem;
  }

  /* Dark mode support */
  [data-bs-theme='dark'] #translation-notice {
    background-color: rgba(13, 202, 240, 0.15);
    border-color: #0dcaf0;
    color: #e9ecef;
  }

  /* Responsive design */
  @media (max-width: 576px) {
    .translation-details {
      font-size: 0.85rem;
    }

    #translation-notice {
      padding: 0.5rem 0.75rem;
    }
  }
</style>

<script>
  // Store dismissed state in localStorage
  document.addEventListener('DOMContentLoaded', function () {
    const translationNotice = document.getElementById('translation-notice');
    if (!translationNotice) return;

    // Check if user has dismissed translation notices
    const dismissedKey = 'translation-notice-dismissed';
    const isDismissed = localStorage.getItem(dismissedKey) === 'true';

    if (isDismissed) {
      translationNotice.style.display = 'none';
    }

    // Handle dismiss button
    const dismissBtn = translationNotice.querySelector('.btn-close');
    if (dismissBtn) {
      dismissBtn.addEventListener('click', function () {
        localStorage.setItem(dismissedKey, 'true');
        // Bootstrap will handle the actual dismissal
      });
    }
  });
</script>
